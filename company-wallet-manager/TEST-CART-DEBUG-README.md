# تست دیباگ سبد خرید

این فایل برای بررسی مشکل نمایش محصولات در سبد خرید استفاده می‌شود.

## نحوه استفاده

### روش 1: از مرورگر
1. فایل `test-cart-debug.php` را در root وردپرس قرار دهید (همان سطح `wp-load.php`)
2. از مرورگر به آدرس زیر دسترسی پیدا کنید:
   ```
   https://your-site.com/test-cart-debug.php
   ```

### روش 2: از CLI
```bash
php test-cart-debug.php
```

## چه چیزهایی بررسی می‌شود؟

1. **بررسی کاربر Employee**: پیدا کردن اولین کاربر employee
2. **بررسی جداول**: بررسی وجود جداول `wp_cwm_cart_items` و `wp_cwm_products`
3. **بررسی مستقیم دیتابیس**: بررسی آیتم‌های سبد خرید مستقیماً از دیتابیس
4. **تست Query**: تست query که در API استفاده می‌شود
5. **تست API Endpoint**: تست مستقیم endpoint `/cwm/v1/cart`

## خروجی

فایل تست اطلاعات زیر را نمایش می‌دهد:

- تعداد آیتم‌های سبد خرید در دیتابیس
- جزئیات هر آیتم (ID، product_id، quantity)
- نتایج query
- پاسخ API endpoint
- خلاصه و تشخیص مشکل

## نکات امنیتی

⚠️ **مهم**: این فایل را بعد از تست حذف کنید!

## تفسیر نتایج

### اگر سبد خرید خالی است:
- ابتدا یک محصول به سبد اضافه کنید
- سپس دوباره تست را اجرا کنید

### اگر آیتم‌ها در دیتابیس هستند اما query نتیجه نمی‌دهد:
- احتمالاً مشکل از JOIN با جدول products است
- بررسی کنید که product_id درست است
- بررسی کنید که محصول حذف نشده باشد

### اگر API خطا می‌دهد:
- بررسی کنید که JWT token درست است
- بررسی کنید که کاربر employee است
- بررسی کنید که permission check درست کار می‌کند

